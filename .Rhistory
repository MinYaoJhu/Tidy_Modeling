labs(title = "predict_2")
predict3 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lmer_fit, chick_test))
predict3
predict3 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_3")
predict4 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lmer_fit_i, chick_test))
predict4
predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4")
plot4 <- predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4")
plot1 <- predict1 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_1")
plot1
plot2 <- predict2 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_2")
plot2
plot3 <- predict3 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_3")
plot3
plot4 <- predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4")
plot4
plot1
plot2
plot3
plot4
predict1
predict1 |>
pivot_longer(cols=c(weight, .pred))
predict1_l <- predict1 |>
pivot_longer(cols=c(weight, .pred))
predict1_l
predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth(se = FALSE)
predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth(se = FALSE) +
theme_light() +
labs(title = "predict_1")
predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_1")
predict_plot_1 <- predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_1")
predict_plot_1
predict2_l <- predict2 |>
pivot_longer(cols=c(weight, .pred))
predict2_l
predict_plot_2 <- predict2_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_2")
predict_plot_2
predict3_l <- predict3 |>
pivot_longer(cols=c(weight, .pred))
predict3_l
predict_plot_3 <- predict3_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_3")
predict_plot_3
predict4_l <- predict4 |>
pivot_longer(cols=c(weight, .pred))
predict4_l
predict_plot_4 <- predict4_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_4")
predict_plot_4
library(gridExtra)
grid.arrange(predict_plot_1, predict_plot_2, predict_plot_3, predict_plot_4)
grid.arrange(plot_1, plot_2, plot_3, plot_4)
grid.arrange(plot1, plot2, plot3, plot4)
plot1 <- predict1 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_1: weight ~ Diet + Time")
plot1
predict_plot_2 <- predict2_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
predict_plot_2
plot2 <- predict2 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
plot2
predict_plot_3 <- predict3_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
predict_plot_3
plot3 <- predict3 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
plot3
predict_plot_4 <- predict4_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
predict_plot_4
plot4 <- predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
plot4
library(tidymodels)
library(kknn)
library(kableExtra)
library(tidyr)
library(multilevelmod)
library(gridExtra)
?ChickWeight
data(ChickWeight)
summary(ChickWeight)
skimr::skim(ChickWeight) #nicer summary
str(ChickWeight)
# Create a simple random sample of Chick indices
set.seed(123)
chick_indices <- group_initial_split(ChickWeight, group = Chick, prop = 0.8, strata = Diet)
chick_indices
# Extract the training and test sets
chick_train <- training(chick_indices)
chick_test <- testing(chick_indices)
str(chick_train)
str(chick_test)
skimr::skim(chick_train)
skimr::skim(chick_test)
lm_model <-
linear_reg() %>%
set_engine("lm")
lm_form_fit1 <-
lm_model %>%
# Recall that Sale_Price has been pre-logged
fit(weight ~ Diet + Time, data = chick_train)
lm_form_fit1
tidy(lm_form_fit1)
glance(lm_form_fit1)
lm_form_fit1 %>%
extract_fit_engine() %>%
summary()
lm_form_fit2 <-
lm_model %>%
# Recall that Sale_Price has been pre-logged
fit(weight ~ Diet * Time, data = chick_train)
lm_form_fit2
tidy(lm_form_fit2)
glance(lm_form_fit2)
lm_form_fit2 %>%
extract_fit_engine() %>%
summary()
show_engines('linear_reg')
lmer_spec <-
linear_reg() %>%
set_engine("lmer")
lmer_fit <-
lmer_spec %>%
fit(weight ~ Time + Diet + (1|Chick), data = chick_train)
lmer_fit
lmer_fit %>%
extract_fit_engine() %>%
summary()
lmer_spec <-
linear_reg() %>%
set_engine("lmer")
lmer_fit_i <-
lmer_spec %>%
fit(weight ~ Time*Diet + (1|Chick), data = chick_train)
lmer_fit_i
lmer_fit_i %>%
extract_fit_engine() %>%
summary()
ChickWeight %>%
ggplot(aes(x=Time, y=weight)) +
geom_smooth(aes(colour=Diet))
ChickWeight %>%
ggplot(aes(x=Time, y=weight)) +
geom_line(aes(colour=Chick))
predict1 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lm_form_fit1, chick_test))
predict1
plot1 <- predict1 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_1: weight ~ Diet + Time")
plot1
predict2 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lm_form_fit2, chick_test))
predict2
plot2 <- predict2 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
plot2
predict3 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lmer_fit, chick_test))
predict3
plot3 <- predict3 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
plot3
predict4 <- chick_test %>%
select(Time, Diet, weight) %>%
bind_cols(predict(lmer_fit_i, chick_test))
predict4
plot4 <- predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
plot4
predict1_l <- predict1 |>
pivot_longer(cols=c(weight, .pred))
predict1_l
predict_plot_1 <- predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_1: weight ~ Diet + Time")
predict_plot_1
predict2_l <- predict2 |>
pivot_longer(cols=c(weight, .pred))
predict2_l
predict_plot_2 <- predict2_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
predict_plot_2
predict3_l <- predict3 |>
pivot_longer(cols=c(weight, .pred))
predict3_l
predict_plot_3 <- predict3_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
predict_plot_3
predict4_l <- predict4 |>
pivot_longer(cols=c(weight, .pred))
predict4_l
predict_plot_4 <- predict4_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
predict_plot_4
grid.arrange(plot1, plot2, plot3, plot4)
grid.arrange(predict_plot_1, predict_plot_2, predict_plot_3, predict_plot_4)
library(tidymodels)
library(kknn)
library(kableExtra)
library(tidyr)
library(multilevelmod)
library(gridExtra)
?ChickWeight
data(ChickWeight)
summary(ChickWeight)
skimr::skim(ChickWeight) #nicer summary
str(ChickWeight)
# Create a simple random sample of Chick indices
set.seed(123)
chick_indices <- group_initial_split(ChickWeight, group = Chick, prop = 0.8, strata = Diet)
chick_indices
# Extract the training and test sets
chick_train <- training(chick_indices)
chick_test <- testing(chick_indices)
str(chick_train)
str(chick_test)
skimr::skim(chick_train)
skimr::skim(chick_test)
lm_model <-
linear_reg() |>
set_engine("lm")
lm_form_fit1 <-
lm_model |>
# Recall that Sale_Price has been pre-logged
fit(weight ~ Diet + Time, data = chick_train)
lm_form_fit1
tidy(lm_form_fit1)
glance(lm_form_fit1)
lm_form_fit1 |>
extract_fit_engine() |>
summary()
lm_form_fit2 <-
lm_model |>
# Recall that Sale_Price has been pre-logged
fit(weight ~ Diet * Time, data = chick_train)
lm_form_fit2
tidy(lm_form_fit2)
glance(lm_form_fit2)
lm_form_fit2 |>
extract_fit_engine() |>
summary()
show_engines('linear_reg')
lmer_spec <-
linear_reg() |>
set_engine("lmer")
lmer_fit <-
lmer_spec |>
fit(weight ~ Time + Diet + (1|Chick), data = chick_train)
lmer_fit
lmer_fit |>
extract_fit_engine() |>
summary()
lmer_spec <-
linear_reg() |>
set_engine("lmer")
lmer_fit_i <-
lmer_spec |>
fit(weight ~ Time*Diet + (1|Chick), data = chick_train)
lmer_fit_i
lmer_fit_i |>
extract_fit_engine() |>
summary()
ChickWeight |>
ggplot(aes(x=Time, y=weight)) +
geom_smooth(aes(colour=Diet))
ChickWeight |>
ggplot(aes(x=Time, y=weight)) +
geom_line(aes(colour=Chick))
predict1 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lm_form_fit1, chick_test))
predict1
plot1 <- predict1 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_1: weight ~ Diet + Time")
plot1
predict2 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lm_form_fit2, chick_test))
predict2
plot2 <- predict2 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
plot2
predict3 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lmer_fit, chick_test))
predict3
plot3 <- predict3 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
plot3
predict4 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lmer_fit_i, chick_test))
predict4
plot4 <- predict4 |>
ggplot(aes(x=weight, y=.pred, color=Diet)) +
geom_point() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
plot4
predict1_l <- predict1 |>
pivot_longer(cols=c(weight, .pred))
predict1_l
predict_plot_1 <- predict1_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_1: weight ~ Diet + Time")
predict_plot_1
predict2_l <- predict2 |>
pivot_longer(cols=c(weight, .pred))
predict2_l
predict_plot_2 <- predict2_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
predict_plot_2
predict3_l <- predict3 |>
pivot_longer(cols=c(weight, .pred))
predict3_l
predict_plot_3 <- predict3_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_3: weight ~ Time + Diet + (1|Chick)")
predict_plot_3
predict4_l <- predict4 |>
pivot_longer(cols=c(weight, .pred))
predict4_l
predict_plot_4 <- predict4_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_4: weight ~ Time*Diet + (1|Chick)")
predict_plot_4
grid.arrange(plot1, plot2, plot3, plot4)
grid.arrange(predict_plot_1, predict_plot_2, predict_plot_3, predict_plot_4)
library(broom.mixed)
install.packages("broom.mixed")
library(broom.mixed)
library(lmerTest)
install.packages("lmerTest")
library(lmerTest)
chick.train %>% group_by(Diet) %>% summarize(chicks = length(unique(Chick)))
chick_train %>% group_by(Diet) %>% summarize(chicks = length(unique(Chick)))
chick_train %>% group_by(Diet) %>% summarize(chicks = length(unique(Chick)))
chick_test %>% group_by(Diet) %>% summarize(chicks = length(unique(Chick)))
tidy(lmer_fit)
tidy(lmer_fit)
glimpse(lmer_fit)
tidy(lmer_fit_i)
glimpse(lmer_fit_i)
glimpse(lmer_fit_i)
tidy(lmer_fit)
glance(lmer_fit)
glance(lmer_fit_i)
bind_rows(glance(lm_form_fit1), glance(lm_form_fit2), glance(lmer_fit),glance(lmer_fit_i))
anova(extract_fit_engine(lm_form_fit1),extract_fit_engine(lm_form_fit2))
anova(extract_fit_engine(lm_form_fit1),
extract_fit_engine(lm_form_fit2),
extract_fit_engine(lmer_fit),
extract_fit_engine(lmer_fit_i))
anova(extract_fit_engine(lm_form_fit1),
extract_fit_engine(lm_form_fit2),
extract_fit_engine(lmer_fit),
extract_fit_engine(lmer_fit_i))
anova(extract_fit_engine(lm_form_fit1),
extract_fit_engine(lm_form_fit2))
anova(extract_fit_engine(lmer_fit),
extract_fit_engine(lmer_fit_i))
anova(extract_fit_engine(lm_form_fit1),
extract_fit_engine(lm_form_fit2))
anova(extract_fit_engine(lmer_fit),
extract_fit_engine(lmer_fit_i))
?predict.merMod
predict_plot_2 <- predict2_l |>
ggplot(aes(x=Time, y=value, color=Diet, lty=name)) +
geom_smooth() +
theme_light() +
labs(title = "predict_2: weight ~ Diet * Time")
predict_plot_2
predict3 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lmer_fit, chick_test))
predict3
predict3 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lmer_fit, chick_test))
predict3
predict2 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lm_form_fit2, chick_test))
predict2
predict1 <- chick_test |>
select(Time, Diet, weight) |>
bind_cols(predict(lm_form_fit1, chick_test))
predict1
grid.arrange(plot1, plot2, plot3, plot4)
install.packages(c("bookdown", "bslib", "checkmate", "cluster", "cpp11", "curl", "data.table", "dbscan", "DiceDesign", "dotCall64", "dplyr", "dqrng", "DT", "e1071", "expm", "fansi", "foreign", "gert", "haven", "htmlwidgets", "httpuv", "jsonlite", "later", "markdown", "Matrix", "nlme", "progress", "PROJ", "qs", "RcppArmadillo", "rgl", "rJava", "robustbase", "rpart", "RSQLite", "Rtsne", "sass", "scales", "segmented", "seqinr", "spatstat.random", "stringfish", "svglite", "testthat", "tiff", "TTR", "units", "vctrs", "vroom", "wk", "XML", "xml2"))
