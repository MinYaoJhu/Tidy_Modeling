"0","#| echo = FALSE, "
"0","#| fig.height = 8,"
"0","#| fig.cap = ""Class boundaries for three models with increasing numbers of hidden units. The boundaries are fit on the training set and shown for the training and test sets."","
"0","#| fig.alt = ""Class boundaries for three models with increasing numbers of hidden units. The boundaries are fit on the training set and shown for the training and test sets. After a single hidden unit, the boundaries become wildly complex. The test set plots show that the more complex models do not conform to the data that was not used to fit the model."""
"0","te_plot <- "
"0","  mlp_res %>% "
"0","  slice(c(1, 4, 20)) %>% "
"0","  mutate("
"0","    probs = map(model, ~ bind_cols(data_grid, predict(.x, data_grid, type = ""prob"")))"
"0","  ) %>% "
"0","  dplyr::select(hidden_units, probs) %>% "
"0","  unnest(cols = c(probs)) %>% "
"0","  mutate("
"0","    label = paste(format(hidden_units), ""units""),"
"0","    label = ifelse(label == "" 1 units"", "" 1 unit"", label)"
"0","  ) %>% "
"0","  ggplot(aes(x = A, y = B)) + "
"0","  geom_point(data = testing_set, aes(color = Class, pch = Class), "
"0","             alpha = 0.5, show.legend = FALSE) + "
"0","  geom_contour(aes( z = .pred_Class1), breaks = 0.5, color = ""black"") + "
"0","  scale_color_manual(values = c(""#CC6677"", ""#88CCEE"")) + "
"0","  facet_wrap(~ label, nrow = 1) + "
"0","  coord_equal() + "
"0","  ggtitle(""Test Set"") + "
"0","  labs(x = ""Predictor A"", y = ""Predictor B"")"
"0",""
"0","tr_plot <- "
"0","  mlp_res %>% "
"0","  slice(c(1, 4, 20)) %>% "
"0","  mutate("
"0","    probs = map(model, ~ bind_cols(data_grid, predict(.x, data_grid, type = ""prob"")))"
"0","  ) %>% "
"0","  dplyr::select(hidden_units, probs) %>% "
"0","  unnest(cols = c(probs)) %>% "
"0","  mutate("
"0","    label = paste(format(hidden_units), ""units""),"
"0","    label = ifelse(label == "" 1 units"", "" 1 unit"", label)"
"0","  ) %>% "
"0","  ggplot(aes(x = A, y = B)) +"
"0","  geom_point(data = training_set, aes(color = Class, pch = Class), "
"0","             alpha = 0.5, show.legend = FALSE) + "
"0","  geom_contour(aes( z = .pred_Class1), breaks = 0.5, color = ""black"") + "
"0","  scale_color_manual(values = c(""#CC6677"", ""#88CCEE"")) + "
"0","  facet_wrap(~ label, nrow = 1) + "
"0","  coord_equal() + "
"0","  ggtitle(""Training Set"") + "
"0","  labs(x = ""Predictor A"", y = ""Predictor B"")"
"0",""
"0","tr_plot / te_plot"
