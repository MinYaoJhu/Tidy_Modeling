"0","set.seed(1201)"
"0","rs <- vfold_cv(training_set, repeats = 10)"
"0",""
"0","# Return the individual resampled performance estimates:"
"0","lloss <- function(...) {"
"0","  perf_meas <- metric_set(roc_auc, mn_log_loss)"
"0","    "
"0","  logistic_reg() %>% "
"0","    set_engine(""glm"", ...) %>% "
"0","    fit_resamples(Class ~ A + B, rs, metrics = perf_meas) %>% "
"0","    collect_metrics(summarize = FALSE) %>%"
"0","    select(id, id2, .metric, .estimate)"
"0","}"
"0",""
"0","resampled_res <- "
"0","  bind_rows("
"0","    lloss()                                    %>% mutate(model = ""logistic""),"
"0","    lloss(family = binomial(link = ""probit""))  %>% mutate(model = ""probit""),"
"0","    lloss(family = binomial(link = ""cloglog"")) %>% mutate(model = ""c-log-log"")     "
"0","  ) %>%"
"0","  # Convert log-loss to log-likelihood:"
"0","  mutate(.estimate = ifelse(.metric == ""mn_log_loss"", -.estimate, .estimate)) %>% "
"0","  group_by(model, .metric) %>% "
"0","  summarize("
"0","    mean = mean(.estimate, na.rm = TRUE),"
"0","    std_err = sd(.estimate, na.rm = TRUE) / sqrt(n()), "
"0","    .groups = ""drop"""
"0","  )"
"2","â†’ [33m[1mA[22m[39m | [33mwarning[39m: glm.fit: fitted probabilities numerically 0 or 1 occurred
"
"2","There were issues with some computations   [1m[33mA[39m[22m: x1"
"2","There were issues with some computations   [1m[33mA[39m[22m: x1"
"2","
"
"0","resampled_res %>% "
"0","  filter(.metric == ""mn_log_loss"") %>% "
"0","  ggplot(aes(x = mean, y = model)) + "
"0","  geom_point() + "
"0","  geom_errorbar(aes(xmin = mean - 1.64 * std_err, xmax = mean + 1.64 * std_err),"
"0","                width = .1) + "
"0","  labs(y = NULL, x = ""log-likelihood"")"
