"0","load(""RData/plm_resids.RData"")"
"0",""
"0","resid_cols <- RColorBrewer::brewer.pal(8, ""Set1"")[1:2]"
"0",""
"0","# Red is where intensity is higher than expected"
"0","plm_plot <- "
"0","  plm_resids %>% "
"0","  mutate(sign = ifelse(Intensity < 0, ""low"", ""high"")) %>% "
"0","  ggplot(aes(x = x, y = y, fill = sign))  + "
"0","  geom_tile(show.legend = FALSE) + "
"0","  facet_wrap(~Sample) + "
"0","  theme("
"0","    panel.grid.major = element_blank(),"
"0","    panel.grid.minor = element_blank(),"
"0","    panel.background = element_blank(),"
"0","    axis.text.x = element_blank(),"
"0","    axis.text.y = element_blank(),"
"0","    axis.ticks = element_blank()"
"0","  ) + "
"0","  labs(x = """", y = """") + "
"0","  scale_fill_manual(values = c(""white"", ""midnightblue"")) + "
"0","  coord_equal() + "
"0","  ggtitle(""(a) Evaluating the quality of two microarray chips using a model."") + "
"0","  theme(plot.title = element_text(hjust = 0.5))"
"0",""
"0",""
"0","ames_plot <- "
"0","  ggplot(ames, aes(x = Latitude, y = Sale_Price)) + "
"0","  geom_point(alpha = .2) + "
"0","  geom_smooth(se = FALSE, method = stats::loess, method.args = list(span = .3), color = ""red"") + "
"0","  scale_y_log10() + "
"0","  ylab(""House Sale Price ($US)"") + "
"0","  ggtitle(""(b) Using a model-based smoother to discover trends."")"
"0",""
"0","grid.arrange(plm_plot, ames_plot, ncol = 1)"
