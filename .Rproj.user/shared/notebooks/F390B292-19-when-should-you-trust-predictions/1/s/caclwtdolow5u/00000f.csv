"0","library(tidymodels)"
"0","tidymodels_prefer()"
"0",""
"0","simulate_two_classes <- "
"0","  function (n, error = 0.1, eqn = quote(-1 - 2 * x - 0.2 * x^2 + 2 * y^2))  {"
"0","    # Slightly correlated predictors"
"0","    sigma <- matrix(c(1, 0.7, 0.7, 1), nrow = 2, ncol = 2)"
"0","    dat <- MASS::mvrnorm(n = n, mu = c(0, 0), Sigma = sigma)"
"0","    colnames(dat) <- c(""x"", ""y"")"
"0","    cls <- paste0(""class_"", 1:2)"
"0","    dat <- "
"0","      as_tibble(dat) %>% "
"0","      mutate("
"0","        linear_pred = !!eqn,"
"0","        # Add some misclassification noise"
"0","        linear_pred = linear_pred + rnorm(n, sd = error),"
"0","        prob = binomial()$linkinv(linear_pred),"
"0","        class = ifelse(prob > runif(n), cls[1], cls[2]),"
"0","        class = factor(class, levels = cls)"
"0","      )"
"0","    dplyr::select(dat, x, y, class)"
"0","  }"
"0",""
"0","set.seed(1901)"
"0","training_set <- simulate_two_classes(200)"
"0","testing_set  <- simulate_two_classes(50)"
