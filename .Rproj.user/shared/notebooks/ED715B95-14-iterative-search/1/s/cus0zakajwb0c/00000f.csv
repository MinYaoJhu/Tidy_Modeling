"0","#| echo = FALSE, "
"0","#| message = FALSE, "
"0","#| warning = FALSE,"
"0","#| out.width = ""80%"","
"0","#| fig.cap = ""How simulated annealing determines the local neighborhood for two numeric tuning parameters. The clouds of points show possible next values where one would be selected at random. "","
"0","#| fig.alt = ""An illustration of how simulated annealing determines what is the local neighborhood for two numeric tuning parameters. The clouds of points show possible next values where one would be selected at random. The candidate points are small circular clouds surrounding the current best point."""
"0",""
"0","glmn_param <- parameters(penalty(), mixture())"
"0","pen_rng <- unlist(range_get(penalty(), original = TRUE))"
"0","mix_rng <- 0:1"
"0",""
"0","iter_1 <- tibble(penalty = 0.025, mixture = .05)"
"0","next_neighbors <- "
"0","  finetune:::random_real_neighbor(iter_1, iter_1, glmn_param, retain = 300) %>% "
"0","  mutate(Iteration = 1)"
"0",""
"0","set.seed(1)"
"0","neighbors_values <- next_neighbors"
"0","best_values <- iter_1 %>% mutate(Iteration = 1)"
"0",""
"0","scoring <- function(x) {"
"0","  - log10(x$penalty) * .1 + x$mixture * 2 + rnorm(nrow(x), sd = .5)"
"0","}"
"0",""
"0","path <- best_values"
"0",""
"0","for (i in 2:6) {"
"0","  set.seed(i + 5)"
"0","  next_scores <- scoring(next_neighbors)"
"0","  next_ind <- which.max(next_scores)"
"0","  next_value <- next_neighbors %>% slice(next_ind) %>% mutate(Iteration = i)"
"0","  "
"0","  best_values <- "
"0","    bind_rows("
"0","      best_values,"
"0","      next_value"
"0","    )"
"0","  path <- bind_rows(path, best_values %>% mutate(Iteration = i))"
"0","  "
"0","  next_neighbors <- "
"0","    finetune:::random_real_neighbor(next_value %>% select(-Iteration), "
"0","                                    path %>% select(-Iteration), "
"0","                                    glmn_param, retain = 300) %>% "
"0","    mutate(Iteration = i)"
"0","  neighbors_values <- "
"0","    bind_rows("
"0","      neighbors_values,"
"0","      next_neighbors"
"0","    )  "
"0","}"
