"0","bo_res <- collect_metrics(svm_bo) %>% mutate(current_best = FALSE)"
"0","for(i in 1:nrow(bo_res)) {"
"0","  bo_res$current_best[i] <- bo_res$mean[i] > max(bo_res$mean[1:(i-1)])"
"0","}"
"0","init_vals <- bo_res %>% dplyr::filter(.iter == 0)"
"0","best_init <- max(bo_res$mean[bo_res$.iter == 0])"
"0","best_bo <- max(bo_res$mean)"
"0","best_bo_iter <- bo_res$.iter[which.max(bo_res$mean)]"
"0","new_best_iter <- bo_res$.iter[which(bo_res$current_best)]"
"0","new_best_iter <- new_best_iter[new_best_iter > 0]"
"0","num_improve <- length(new_best_iter)"
"0","last_iter <- max(collect_metrics(svm_bo)$.iter)"
"0",""
"0","iter_1_roc <- bo_res$mean[bo_res$.iter == 1]"
"0","iter_1_imp <- iter_1_roc > best_init"
"0","iter_1_text <- "
"0","  paste0("
"0","    ifelse(iter_1_imp, ""showed an improvement, resulting in an ROC value of "","
"0","           ""failed to improve the outcome with an ROC value of ""),"
"0","    round(iter_1_roc, 5), ""."""
"0","  )"
"0",""
"0","iter_2_roc <- bo_res$mean[bo_res$.iter == 2]"
"0","iter_2_imp <- iter_2_roc > max(bo_res$mean[bo_res$.iter < 2])"
"0","iter_2_text <- "
"0","  dplyr::case_when("
"0","    !iter_1_imp &  !iter_2_imp ~ "
"0","      paste0(""the second iteration also failed to yield an improvement.""),"
"0","    !iter_1_imp &   iter_2_imp ~ "
"0","      paste0(""the second iteration did yield a better result with an area under the ROC curve of "", "
"0","             round(iter_2_roc, 5), "".""),"
"0","    iter_1_imp &  !iter_2_imp ~ "
"0","      paste0(""the second iteration did not continue the trend with a suboptimal ROC value of "","
"0","             round(iter_2_roc, 5), "".""),"
"0","    iter_1_imp &  !iter_2_imp ~ "
"0","      paste0(""the second iteration further increased the outcome value (ROC = "","
"0","             round(iter_2_roc, 5), "")."") "
"0","  )"
"0",""
"0","if (num_improve > 1) {"
"0","  improve_text <-"
"0","    paste0("
"0","      ""There were a total of "","
"0","      num_improve,"
"0","      "" improvements in the outcome along the way at iterations "","
"0","      knitr::combine_words(new_best_iter),"
"0","      ""."""
"0","    )"
"0","} else {"
"0","  improve_text <-"
"0","    paste0(""There was only a single improvement in the outcome at iteration "","
"0","           new_best_iter,"
"0","           ""."")"
"0","}"
"0",""
"0","if (last_iter < 25) {"
"0","  last_bo_text <-"
"0","    paste0("
"0","      ""There were no more improvements and the default option is to stop if no progress is made after `no_improve = "","
"0","      ctrl$no_improve,"
"0","      ""` more steps. The last step was:"""
"0","    )"
"0","} else {"
"0","  last_bo_text <- ""The last step was:"""
"0","}"
