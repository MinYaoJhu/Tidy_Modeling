"0","source(""extras/nonlinear_function.R"")"
"0","grid <- "
"0","  tibble(x = seq(0, 1, length.out = 200)) %>% "
"0","  mutate(y = purrr::map_dbl(x, nonlin_function, error = FALSE))"
"0",""
"0","set.seed(121)"
"0","current_iter <- tibble(x = c(.09, .41,  .55, .7, .8)) %>% "
"0","  mutate(y = purrr::map_dbl(x, nonlin_function))"
"0",""
"0","gp <- GPfit::GP_fit(matrix(current_iter$x, ncol = 1), current_iter$y)"
"0",""
"0","gp_pred <- "
"0","  predict(gp, matrix(grid$x, ncol = 1))$complete_data %>% "
"0","  as_tibble() %>% "
"0","  setNames(c(""x"", "".mean"", "".sd""))  %>% "
"0","  mutate(.sd = sqrt(.sd))"
"0",""
"0","gp_pred <- "
"0","  gp_pred %>% "
"0","  bind_cols("
"0","    exp_improve() %>% "
"0","      predict(gp_pred, maximize = TRUE, iter = 1, best = max(current_iter$y)) %>% "
"0","      setNames(""exp_imp"")"
"0","  ) %>% "
"0","  bind_cols("
"0","    conf_bound(kappa = .1) %>% "
"0","      predict(gp_pred, maximize = TRUE, iter = 1, best = max(current_iter$y)) %>% "
"0","      setNames(""conf_int_01"")"
"0","  ) %>% "
"0","  bind_cols("
"0","    conf_bound(kappa = 1) %>% "
"0","      predict(gp_pred, maximize = TRUE, iter = 1, best = max(current_iter$y)) %>% "
"0","      setNames(""conf_int_1"")"
"0","  )"
